# 🧪 Lab: Exploiting Path Mapping for Web Cache Deception

## 📝 Description
Exploiting path mapping to serve sensitive user-specific data from cache to unintended users using static file extension injection.

## 🔐 Lab Credentials
- **Username:** `wiener`
- **Password:** `peter`

## 🎯 Objective
Find the **API key for user `carlos`** by exploiting discrepancies between how the origin server maps URL paths and how the cache stores them.

## 🧠 Required Knowledge
- How regex endpoints map URL paths to backend resources.
- How to detect and exploit discrepancies in URL mapping between the cache and the origin server.

## 🧪 Exploit Steps

### Step 1: Abstract Path Testing
1. Go to **Burp Suite > Proxy > HTTP History**.
2. Find the request: `GET /my-account` → **Send to Repeater**.
3. Modify the path to `/my-account/abc` and send the request.
4. Observe the response still shows your API key → proves the server maps it to `/my-account`.

### Step 2: Trigger Cache Behavior
1. In Repeater, change the path to `/my-account/abc.js`.
2. Send the request.
   - You should see `X-Cache: miss` and `Cache-Control: max-age=30`.
3. Resend the same request within 30 seconds.
   - You should now see `X-Cache: hit`, meaning the response is cached.
   - copy  /resource/js/tracking.js file 

### Step 3: Exploit with Cached API Key
1. Go to **Burp > Exploit Server** → Click **Go to exploit server**.
2. Craft the payload:
   ```html
   <script>
     location = 'https://<YOUR-LAB-ID>.web-security-academy.net/my-account/wcd.js';
   </script>
3. replace lab_id with your lab_id
4. click deliver exploit to victim.
Step 4 visit the payload url
```https://<LAB_ID>.web-security-academy.net/my-account/abc.js```
5. now you should see carlos's api key submit the api key to solve the lab.
